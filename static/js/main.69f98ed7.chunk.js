(this["webpackJsonpconnect4-ai"]=this["webpackJsonpconnect4-ai"]||[]).push([[0],{273:function(e,t,a){e.exports=a(300)},284:function(e,t){},285:function(e,t){},293:function(e,t){},296:function(e,t){},297:function(e,t){},299:function(e,t,a){},300:function(e,t,a){"use strict";a.r(t);var n=a(35),r=a.n(n),o=a(230),c=a.n(o),i=a(17),s=a(4),u=a.n(s),l=a(11),m=a(5),d=a(10),f=a(13),h=a(14),v=function(e){var t=e.value,a=e.onClick;return r.a.createElement("button",{className:"btn btn-primary btn-lg",type:"button",onClick:function(e){e.target.blur(),a()}},t)},p=a(231),g=a.n(p),b=function(e){for(var t=e.ROWS,a=e.COLS,n=e.onClick,o=[],c=0;c<t;c++){for(var i=[],s=function(e){var t=r.a.createElement("td",{key:"".concat(c,"-").concat(e)},r.a.createElement("button",{type:"button",className:"board-button",id:"button-".concat(c,"-").concat(e),onClick:function(){return n(e)}}));i.push(t)},u=0;u<a;u++)s(u);var l=r.a.createElement("tr",{key:c},i);o.push(l)}return r.a.createElement("div",{className:"table-responsive"},r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,o)))},y=a(40),I=a(18),E="https://connect4-ai.storage.googleapis.com/connect4model.json",w=function(){function e(){var t=this;Object(m.a)(this,e),this.checkWin=function(e,a,n){for(var r=!1,o=0;o<4;o++){var c=a-o,i=a+4-o-1,s=e-o,u=e+4-o-1;c>=0&&i<7&&(r=t.checkWinHelper(e,c,!1,!0,!1,!1,n)||r),s>=0&&u<6&&(r=t.checkWinHelper(s,a,!0,!1,!1,!1,n)||r),c>=0&&i<7&&s>=0&&u<6&&(r=t.checkWinHelper(s,c,!0,!0,!1,!1,n)||r);var l=a+o;a-4+o+1>=0&&l<7&&s>=0&&u<6&&(r=t.checkWinHelper(s,l,!0,!0,!1,!0,n)||r)}return r},this.checkWinHelper=function(e,a,n,r,o,c,i){for(var s=0;s<4;s++){var u=e+(n?o?-s:s:0),l=a+(r?c?-s:s:0);if(t.board[u][l]!==i)return!1}for(var m=0;m<4;m++){var d=e+(n?o?-m:m:0),f=a+(r?c?-m:m:0);document.getElementById("button-".concat(d,"-").concat(f)).classList.add("win")}return!0},this.reset()}return Object(d.a)(e,[{key:"reset",value:function(){this.board=new Array(6).fill(0).map((function(){return new Array(7).fill(0)})),this.turn=1}},{key:"step",value:function(e){var t=this.getDropRow(e);this.board[t][e]=this.turn;var a=this.turn;return this.turn=1===this.turn?-1:1,this.checkDraw()?{board:this.getState(),turn:this.turn,winner:0,dropRow:t}:this.checkWin(t,e,a)?{board:this.getState(),turn:this.turn,winner:a,dropRow:t}:{board:this.getState(),turn:this.turn,winner:2,dropRow:t}}},{key:"getState",value:function(){var e,t=[],a=Object(i.a)(this.board);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(Object(I.a)(n))}}catch(r){a.e(r)}finally{a.f()}return t}},{key:"getInvertedState",value:function(){for(var e=this.getState(),t=0;t<6;t++)for(var a=0;a<7;a++)1===e[t][a]?e[t][a]=-1:-1===e[t][a]&&(e[t][a]=1);return e}},{key:"checkDraw",value:function(){return k(this.board)}},{key:"getValidActions",value:function(){return N(this.board)}},{key:"getDropRow",value:function(e){return A(this.board,e)}}]),e}();function k(e){for(var t=0;t<7;t++)if(0===e[0][t])return!1;return!0}function N(e){for(var t=[],a=0;a<7;a++)0===e[0][a]&&t.push(a);return t}function A(e,t){for(var a=5;a>=0;a--)if(0===e[a][t])return a;return-1}function M(e){return Array.isArray(e)||(e=[e]),y.h(e).reshape([-1,6,7,1])}function O(e,t,a,n,r,o){if(0===t||function(e){return S(e,1,4)>0||S(e,-1,4)>0||k(e)}(e))return function(e,t){for(var a=0,n=0;n<3;n++)a+=Math.pow(10,2*n+1)*S(e,t,n+2),a-=Math.pow(10,2*n)*S(e,x(t),n+2);return a}(e,o);if(r){var c,s=Number.NEGATIVE_INFINITY,u=Object(i.a)(N(e));try{for(u.s();!(c=u.n()).done;){var l=O(C(e,c.value,o),t-1,a,n,!1,o);if(s=Math.max(s,l),(a=Math.max(a,l))>=n)break}}catch(v){u.e(v)}finally{u.f()}return s}var m,d=Number.POSITIVE_INFINITY,f=Object(i.a)(N(e));try{for(f.s();!(m=f.n()).done;){var h=O(C(e,m.value,x()),t-1,a,n,!0,o);if(d=Math.min(d,h),(n=Math.min(n,h))<=a)break}}catch(v){f.e(v)}finally{f.f()}return d}function S(e,t,a){for(var n=0,r=0;r<6;r++)for(var o=0;o<4;o++){for(var c=0,i=0,s=0;s<4;s++){var u=e[r][o+s];u===t?c++:0===u&&i++}c===a&&i===4-c&&n++}for(var l=0;l<3;l++)for(var m=0;m<7;m++){for(var d=0,f=0,h=0;h<4;h++){var v=e[l+h][m];v===t?d++:0===v&&f++}d===a&&f===4-d&&n++}for(var p=0;p<3;p++)for(var g=0;g<4;g++){for(var b=0,y=0,I=0;I<4;I++){var E=e[p+I][g+I];E===t?b++:0===E&&y++}b===a&&y===4-b&&n++}for(var w=0;w<3;w++)for(var k=6;k>2;k--){for(var N=0,A=0,M=0;M<4;M++){var O=e[w+M][k-M];O===t?N++:0===O&&A++}N===a&&A===4-N&&n++}return n}function x(e){return 1===e?-1:1}function C(e,t,a){var n,r=[],o=Object(i.a)(e);try{for(o.s();!(n=o.n()).done;){var c=n.value;r.push(Object(I.a)(c))}}catch(s){o.e(s)}finally{o.f()}return r[A(r,t)][t]=a,r}var j=["Player","Rookie (random)","Easy (1-step minimax)","Normal (deep Q-learning)","Hard (2-step minimax)","Expert (4-step minimax)","Extreme (6-step minimax)"],P=function(e){Object(f.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).handleOnChangePlayer=function(e,t){var a=e.target.selectedIndex;n.setState(1===t?{p1Mode:a}:{p2Mode:a},n.runAI)},n.handleOnChangeAISpeed=function(e){var t=Number(e.target.value);n.setState({aiSpeed:t},n.runAI)},n.handleOnClickNewGame=function(){n.game.reset(),n.setState({board:n.game.getState(),turn:1,winner:2},n.runAI);for(var e=0;e<6;e++)for(var t=0;t<7;t++){var a=document.getElementById("button-".concat(e,"-").concat(t));a.classList.remove("p1"),a.classList.remove("p2"),a.classList.remove("win")}},n.handleOnClickBoard=function(e){2===n.state.winner&&(1===n.state.turn&&0!==n.state.p1Mode||-1===n.state.turn&&0!==n.state.p2Mode||n.game.getValidActions().includes(e)&&n.step(e))},n.step=function(e){var t=n.game.step(e),a=t.board,r=t.turn,o=t.winner,c=t.dropRow;document.getElementById("button-".concat(c,"-").concat(e)).classList.add("p".concat(n.getPlayerNumber())),n.setState({board:a,turn:r,winner:o},n.runAI)},n.runAI=function(){clearTimeout(n.timer),2===n.state.winner&&(n.timer=setTimeout((function(){1===n.state.turn&&0!==n.state.p1Mode?1===n.state.p1Mode?n.randomAI():2===n.state.p1Mode?n.minimaxAI(1):3===n.state.p1Mode?n.qLearningAI():4===n.state.p1Mode?n.minimaxAI(2):5===n.state.p1Mode?n.minimaxAI(4):6===n.state.p1Mode&&n.minimaxAI(6):-1===n.state.turn&&0!==n.state.p2Mode&&(1===n.state.p2Mode?n.randomAI():2===n.state.p2Mode?n.minimaxAI(1):3===n.state.p2Mode?n.qLearningAI():4===n.state.p2Mode?n.minimaxAI(2):5===n.state.p2Mode?n.minimaxAI(4):6===n.state.p2Mode&&n.minimaxAI(6))}),10/n.state.aiSpeed))},n.game=new w,n.state={board:n.game.getState(),turn:1,winner:2,p1Mode:0,p2Mode:0,aiSpeed:.02},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.loadModel()}},{key:"loadModel",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.c(E);case 2:this.model=e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPlayerNumber",value:function(){return 1===this.state.turn?"1":"2"}},{key:"randomAI",value:function(){var e=this.game.getValidActions(),t=e[Math.floor(Math.random()*e.length)];this.step(t)}},{key:"minimaxAI",value:function(e){var t,a=Number.NEGATIVE_INFINITY,n=[],r=Object(i.a)(this.game.getValidActions());try{for(r.s();!(t=r.n()).done;){var o=t.value,c=O(C(this.state.board,o,this.state.turn),e-1,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,!1,this.state.turn);c>a?(a=c,n=[o]):c===a&&n.push(o)}}catch(u){r.e(u)}finally{r.f()}var s=n[Math.floor(Math.random()*n.length)];this.step(s)}},{key:"qLearningAI",value:function(){var e=this;y.j((function(){var t=M(1===e.state.turn?e.game.getState():e.game.getInvertedState()),a=Array.from(e.model.predict(t).dataSync()),n=e.game.getValidActions(),r=[];a.forEach((function(e,t){n.includes(t)&&r.push({q:e,action:t})}));var o=-1/0,c=-1;r.forEach((function(e){e.q>o&&(o=e.q,c=e.action)})),e.step(c)}))}},{key:"render",value:function(){var e,t=this;return e=2!==this.state.winner?0===this.state.winner?"Draw":"Player ".concat(1===this.state.winner?"1":"2"," wins"):"Player ".concat(1===this.state.turn?"1":"2"," turn"),r.a.createElement("div",{className:"App container-fluid text-center pt-5"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("h1",{className:"font-weight-bold"},"Connect 4 AI"),r.a.createElement("h5",null,"Play versus Player/AI or watch AI play against AI."),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col col-auto pt-3"},r.a.createElement("h4",null,"Player 1"),r.a.createElement("select",{onChange:function(e){return t.handleOnChangePlayer(e,1)}},j.map((function(e){return r.a.createElement("option",{key:"p1-".concat(e)},e)})))),r.a.createElement("div",{className:"col col-auto pt-3"},r.a.createElement("h4",null,"Player 2"),r.a.createElement("select",{onChange:function(e){return t.handleOnChangePlayer(e,-1)}},j.map((function(e){return r.a.createElement("option",{key:"p2-".concat(e)},e)}))))),r.a.createElement("div",{className:"row justify-content-center pt-3"},r.a.createElement("div",{className:"col col-10 col-sm-8 col-md-6 col-lg-4 col-xl-2"},r.a.createElement("input",{type:"range",min:.01,max:1,step:.01,defaultValue:this.state.aiSpeed,onChange:this.handleOnChangeAISpeed}))),r.a.createElement("h5",null,"AI speed: ",this.state.aiSpeed),r.a.createElement("div",{className:"mt-3"},r.a.createElement(v,{value:"New Game",onClick:this.handleOnClickNewGame})),r.a.createElement("h4",{className:"mt-5"},e),r.a.createElement("div",{className:"row justify-content-center pt-3"},r.a.createElement("div",{className:"col col-auto"},r.a.createElement(b,{ROWS:6,COLS:7,onClick:this.handleOnClickBoard}))))),r.a.createElement(g.a,{href:"https://github.com/ryantran2165/connect4-ai",bannerColor:"#222",octoColor:"#7fffd4",target:"_blank"}))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(298),a(299);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[273,1,2]]]);
//# sourceMappingURL=main.69f98ed7.chunk.js.map